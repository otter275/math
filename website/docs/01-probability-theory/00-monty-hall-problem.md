---
id: '00'
title: '몬티홀 문제'
sidebar_label: '유명한 확률론 문제들'
---
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" />

#### 이번 포스팅에서는 유명한 몬티홀 문제에 대해서 풀어 보겠습니다.

**주의.**  

- 몬티홀 문제에 대한 직관적인 풀이 방법은 인터넷에 이미 많이 공유가 되어 있습니다. 그러므로 이 포스팅에서는 몬티홀 문제를 "조건부 확률"에 중점을 두어서 풀어 보도록 하겠습니다.  

- 직관적인 풀이 방법이 궁금 하신 분은 아래의 칸아카데이를 참조 해 보세요.  
[칸아카데미 링크](https://youtu.be/Xp6V_lO1ZKA)  

- 몬티홀 문제에 대한 자세한 소개는 아래의 위키백과를 참조 하세요.  
[위키피디아 링크](https://en.wikipedia.org/wiki/Monty_Hall_problem)  
<br/>

#### 문제 풀이

자 그러면 지금 부터 조건부 확률의 관점으로 몬티홀 문제를 풀어 보겠습니다.

**1. 우선 각각의 사건에 대해서 설정 하겠습니다.**

- 첫 번째로 내가 문을 선택하는 사건에 대해서 정의 하겠습니다.  
  * 내문1 = {내가 첫 번째 문을 선택하는 사건}
  * 내문2 = {내가 두 번째 문을 선택하는 사건}
  * 내문3 = {내가 세 번째 문을 선택하는 사건}  

- 두 번째로 어떤 문에 있는 사건에 대해서 정의 하겠습니다.
  * 차문1 = {차가 첫 번째 문뒤에 있는 사건}
  * 차문2 = {차가 두 번째 문뒤에 있는 사건}
  * 차문3 = {차가 세 번째 문뒤에 있는 사건}
  
- 마지막으로 몬티홀이 문을 열어 주는 사건에 대해서 정의 하겠습니다.
  * 몬티1 = {몬티홀이 첫 번째 문을 열어서 염소를 보여 주는 사건}
  * 몬티2 = {몬티홀이 두 번째 문을 열어서 염소를 보여 주는 사건}
  * 몬티3 = {몬티홀이 세 번째 문을 열어서 염소를 보여 주는 사건}
<br/>

**2. 정의 된 사건을 바탕으로 확률을 표현 하겠습니다.**

- 내가 첫 번째 문을 선택하는 사건에 대한 확률은 다음과 같습니다.
$$P(내문1)=\frac{1}{3}$$

  * 여기서 확률이 $\frac{1}{3}$인 이유는 내가 어떤 문을 선택 할 단순 사건에 대한 확률은 어떤 편견 없이 같게 정해져 있다고 가정 하기 때문입니다.
  * 또한 내가 두 번째, 세 번째 문을 선택하는 사건의 확률도 확률의 대칭성에 $\frac{1}{3}$로 같음을 알 수 있습니다.
  
- 첫 번째 문을 고른 상태에서 각각 차가 첫 번째, 두 번째, 세 번째 문에 있는 사건의 확률은 다음과 같습니다.
$$P(차문1|내문1)=\frac{1}{3}, \; P(차문2|내문1)=\frac{1}{3}, \; P(차문3|내문1)=\frac{1}{3}$$

   * 여기서 내가 문을 선택하는 사건과 차가 어떤 문 뒤에 있는 사건의 관계는 독립사건입니다. 또한 어떤 문 뒤에 차거 있을 가능성은 같게 정해져 있기 때문에 확률이 $\frac{1}{3}$임을 알 수 있습니다.

   * 두 번째, 세 번째 문을 고른 상태에서의 조건부 확률도 확률의 대칭성에 의해 같음을 예측 할 수 있습니다.



- 다음으로 1번과 2번의 사건을 바탕으로 몬티홀이 각각의 문을 열어 주는 사건에 대한 확률은 다음과 같습니다.
$$P(몬티1|내문1 \cap 차1)=0, ; P(몬티2|내문1 \cap 차문1)=\frac{1}{2}, P(몬티3|내문1 \cap 차문1)=\frac{1}{2}$$

  * 여기서 몬티홀이 첫 번째 문을 열어서 염소를 보여 줄 때 내가 이미 첫 번째 문을 선택 했거나 차가 첫 번째 문 뒤에 있다면 몬티홀은 첫 번째 문을 열 수 없기 때문에 확률은 0 입니다. 그 밖에 남는 경우는 몬티홀이 두 번재 문을 열어서 염소를 보여 주거나 세 번째 문을 열어서 염소를 보여 주는 것인데 이 때는 각각 두 문을 열 가능성이 동일 하므로 확률은 각각 $\frac{1}{2}$입니다.


- $P(몬티1|내문1 \cap 차문2) = 0$, $P(몬티2|내문1 \cap 차문2) = 0$, $P(몬티3|내문1 \cap 차문2) = 1$

  * 여기서 몬티홀이 첫 번째 문을 열어서 염소를 보여 줄 때 내가 이미 첫 번째 문을 선택 했거나 차가 첫 번째 문 뒤에 있다면 몬티홀은 첫 번째 문을 열 수 없기 때문에 확률은 0 입니다. 그 다음 몬티홀이 두 번째 문을 열어서 염소를 보여 줄 때 차가 문 뒤에 있으므로 이 경우도 확률은 0입니다. 마지막으로 몬티홀이 세 번째 문을 열어서 보여 줄 때 남는 문이 세 번째 문 밖에 없으므로 이 때의 확률은 1입니다.
  

- $P(몬티1|내문1 \cap 차문3) = 0$, $P(몬티2|내문1 \cap 차문3) = 1$, $P(몬티3|내문1 \cap 차문3) = 0$

  * 여기서 몬티홀이 첫 번째 문을 열어서 염소를 보여 줄 때 내가 이미 첫 번째 문을 선택 했거나 차가 첫 번째 문 뒤에 있다면 몬티홀은 첫 번째 문을 열 수 없기 때문에 확률은 0 입니다. 그 다음 몬티홀이 세 번째 문을 열어서 염소를 보여 줄 때 차가 문 뒤에 있으므로 이 경우도 확률은 0입니다. 마지막으로 몬티홀이 두 번째 문을 열어서 보여 줄 때 남는 문이 두 번째 문 밖에 없으므로 이 때의 확률은 1입니다.
<br/>
<br/>


- 내가 1번문을 선택 한 것과 차가 각각 1번문, 2번문, 3번문에 있을 때의 교사건의 확률은 다음과 같습니다.
$$P(내문1 \cap 차문1)=P(차문1) \cdot P(차문1|내문1)=\frac{1}{3} \cdot \frac{1}{3}= \frac{1}{9}$$ $$P(내문1 \cap 차문2)=P(내문1) \cdot P(차문2|내문1)=\frac{1}{3} \cdot \frac{1}{3}= \frac{1}{9}$$ $$P(내문1 \cap 차문3)=P(내문1) \cdot P(차문3|내문1)=\frac{1}{3} \cdot \frac{1}{3}= \frac{1}{9}$$

  * 여기서 교사건의 의미는 사건이 순차적으로 내가 n번문을 고르고 차가 n번문 뒤에(또는 동시에 일어난 사건) 있다고 해석을 하면 자연스럽게 조건부 확률로 conditioning이 가능합니다. 확률값 자체는 위에서 미리 정의하고 구한 확률값을 그대로 적용한 것입니다.


- 내가 1번문을 선택하고 차가 1번문에 있고 각각 몬티홀이 1번문, 2번문, 3번문을 열어줄 때의 교사건의 확률은 다음과 같습니다.
$$\begin{aligned} P(내문1 \cap 차문1 \cap 몬티1) &= P(내문1) \cdot P(차문1|내문1) \cdot P(몬티1|내문1 \cap 차문1) \ &= \frac{1}{3} \cdot \frac{1}{3} \cdot 0 \ &= 0 \end{aligned}$$ $$\begin{aligned} P(내문1 \cap 차문1 \cap 몬티2) &= P(내문1) \cdot P(차문1|내문1) \cdot P(몬티2|내문1 \cap 차문1) \ &= \frac{1}{3} \cdot \frac{1}{3} \cdot \frac{1}{2} \ &= \frac{1}{18} \end{aligned}$$ $$\begin{aligned} P(내문1 \cap 차문1 \cap 몬티3)&=P(내문1) \cdot P(차문1|내문1) \cdot P(몬티3|내문1 \cap 차문1) \ &=\frac{1}{3} \cdot \frac{1}{3} \cdot \frac{1}{2} \ &= \frac{1}{18} \end{aligned}$$

  * 여기서도 교사건의 의미를 사건이 순차적으로 내가 n번문을 고르고 차가 n번문 뒤에 있고 몬티홀이 n번문을 열어서 염소를 보여 준 사건이라고 해석을 하면 자연스럽게 조건부 확률로 conditioning이 가능합니다. 확률값 자체는 위에서 미리 정의하고 구한 확률값을 그대로 적용한 것입니다.


- 내가 1번문을 선택하고 차가 2번문에 있고 각각 몬티홀이 1번문, 2번문, 3번문을 열어줄 때의 교사건의 확률은 다음과 같습니다.
$$\begin{aligned} P(내문1 \cap 차문2 \cap 몬티1) &=P(내문1) \cdot P(차문2|내문1) \cdot P(몬티1|내문1 \cap 차문2) \ &=\frac{1}{3} \cdot \frac{1}{3} \cdot 0 \ &= 0 \end{aligned}$$ $$\begin{aligned} P(내문1 \cap 차문2 \cap 몬티2) &=P(내문1) \cdot P(차문2|내문1) \cdot P(몬티2|내문1 \cap 차문2) \ &=\frac{1}{3} \cdot \frac{1}{3} \cdot 0 \ &= 0 \end{aligned}$$ $$\begin{aligned} P(문1 \cap 차2 \cap 몬3) &=P(문1) \cdot P(차2|문1) \cdot P(몬3|문1 \cap 차2) \ &=\frac{1}{3} \cdot \frac{1}{3} \cdot 1 \ &= \frac{1}{9} \end{aligned}$$

  * 여기서도 교사건의 의미를 사건이 순차적으로 내가 n번문을 고르고 차가 n번문 뒤에 있고 몬티홀이 n번문을 열어서 염소를 보여 준 사건이라고 해석을 하면 자연스럽게 조건부 확률로 conditioning이 가능합니다. 확률값 자체는 위에서 미리 정의하고 구한 확률값을 그대로 적용한 것입니다.
  

- 내가 1번문을 선택하고 차가 3번문에 있고 각각 몬티홀이 1번문, 2번문, 3번문을 열어줄 때의 교사건의 확률은 다음과 같습니다.
$$\begin{aligned} P(내문1 \cap 차문3 \cap 몬티1) &=P(내문1) \cdot P(차문3|내문1) \cdot P(몬티1|내문1 \cap 차문3) \ &=\frac{1}{3} \cdot \frac{1}{3} \cdot 0 \ &= 0 \end{aligned}$$ $$\begin{aligned} P(내문1 \cap 차문3 \cap 몬티2) &=P(내문1) \cdot P(차문3|내문1) \cdot P(몬티2|내문1 \cap 차문3) \ &=\frac{1}{3} \cdot \frac{1}{3} \cdot 1 \ &= \frac{1}{9} \end{aligned}$$ $$\begin{aligned} P(내문1 \cap 차문3 \cap 몬티3) &=P(내문1) \cdot P(차문3|내문1) \cdot P(몬티3|내문1 \cap 차문3) \ &=\frac{1}{3} \cdot \frac{1}{3} \cdot 0 \ &= 0 \end{aligned}$$

  * 여기서도 교사건의 의미를 사건이 순차적으로 내가 n번문을 고르고 차가 n번문 뒤에 있고 몬티홀이 n번문을 열어서 염소를 보여 준 사건이라고 해석을 하면 자연스럽게 조건부 확률로 conditioning이 가능합니다. 확률값 자체는 위에서 미리 정의하고 구한 확률값을 그대로 적용한 것입니다.
<br/>


3. 자 이제 우리가 구해야 할 목표 확률을 설정 하고 계산 해 보겠습니다.  

- 우리가 구하고 싶은 목표 확률을 다음으로 풀어 써 보겠습니다.

  * "내가 첫 번째 문을 선택 했을 때 몬티홀이 두 번째 문을 열어 줬다면 세 번째 문에 차가 있을 확률은 얼마일까?"

- 이 문장을 조건부 확률식으로 바꿔 쓰기 위해 다시 한번 표현을 간략하게 해 보면 다음과 같습니다.

  * "몬티홀이 두 번째 문을 열어준 조건에서 내가 첫 번째 문을 선택하고 세 번째 문 뒤에 차가 있을 확률은 얼마일까?"
    + 즉, 이 말은 몬티홀이 두 번째 문을 열어서 염소를 보여 준후 내가 선택한 첫 번째 문의 조건에서 세 번째 문으로 선택을 바꿨을 경우에 차를 선택할 수 있는 확률로 해석 할 수 있습니다.
       - 위 문장을 조건부 확률로 정의 하겠습니다.
       $$P(내문1 \cap 차3|몬티2)$$
       - 위의 조건부 확률을 조건부 확률의 정의로 표현 하면 다음과 같습니다.
       $$P(내문1 \cap 차3|몬티2) = \frac{P((내문1 \cap 차3) \cap 몬티2)}{P(몬티2)}$$

- 분모의 확률값 부터 계산 해 보겠습니다.

  * 여기서 P(몬티2)의 확률은 전체 확률의 법칙의 정의를 통해서 다음과 같이 표현 할 수 있습니다.$$P(몬티2)=P(몬티2|내문1 \cap 차문3) \cdot P(내문1 \cap 차문3)P(몬티2|내문1 \cap 차문2) \cdot P(내문1 \cap 차문2)P(몬티2|내문1 \cap 차문1) \cdot P(내문1 \cap 차문1)$$

  * 그리고 위의 확률값을 위에서 우리가 계산한 확률값을 통해서 계산해 보면 다음과 같습니다.$$\begin{aligned} 
      P(몬티2) &= 1 \cdot \frac{1}{9} + 0 \cdot \frac{1}{9} + \frac{1}{2} \cdot \frac{1}{9} \ 
      &= \frac{3}{18} \end{aligned}$$

- 이제 분자의 확률값을 위에서 우리가 계산한 확률값을 통해서 계산 해 보겠습니다.$$\begin{aligned} 
    P((내문1 \cap 차3) \cap 몬티2) &= P(내문1 \cap 차문3 \cap 몬티2) \ 
    &= P(내문1) \cdot P(차문3|내문1) \cdot P(몬티2|내문1 \cap 차문3) \ 
    &= \frac{1}{3} \cdot \frac{1}{3} \cdot 1 \ 
    &= \frac{1}{9} \end{aligned}$$

- 이제 각각 계산한 분모와 분자의 확률값을 가지고 우리의 목표 확률값 계산을 완료 하겠습니다.$$\begin{aligned} P(내문1 \cap 차3|몬티2) &= \frac{P((내문1 \cap 차3) \cap 몬티2)}{P(몬티2)} &= \frac{\frac{2}{18}}{\frac{3}{18}} &= \frac{2}{3} \end{aligned}$$

**4. 다시 여기서 결과의 뜻에 대해서 정리 하겠습니다.**  

- 확률의 계산 결과가 $\frac{2}{3}$ 인데요. 이 말은 몬티홀이 두 번째 문을 열어서 염소를 보여 준 후 내가 선택한 첫 번째 문의 조건에서 세 번째 문으로 선택을 바꿨을 경우에 차를 선택할 수 있는 확률이 $\frac{2}{3}$란 의미입니다. 확률의 총합은 1이므로 몬티홀이 두 번째 문을 열어서 염소를 보여 준 조건에서 내가 선택한 첫 번째 문의 문 뒤에 차가 있을 확률은 $\frac{1}{3}$ 입니다.

  * $\frac{2}{3}$는 $\frac{1}{3}$ 보다 두 배 크므로 위의 시나리오에서 몬티홀이 2번문을 열어주었을 때 1번문에 머무는 것보다 3번문으로 선택을 바꾸는 것이 차를 선택할 확률이 두 배 더 큼을 알 수 있으므로 내가 첫 번재 선택한 1번문에서 3번문으로 바꾸는 것이 차를 선택할 수 있는 더 높은 확률을 보장 받는 선택입니다.

  * 내가 첫 번째 문을 선택 했을 때 몬티홀이 세 번째 문을 열어서 염소를 보여 주는 경우에도 확률의 대칭성에 의해 두 번째 문으로 선택을 바꾸는 것이 차를 선택하는 것에 대해 $\frac{2}{3}$의 확률을 보장합니다.



**5. 마지막으로 위의 조건부 확률을 베이즈 정리로 구해도 결과는 당연히 동일 합니다.**  
$$\begin{aligned}
P(내문1 \cap 차3|몬티2)
&= \frac{P(몬티2|내문1 \cap 차3) \cdot P(내문1 \cap 차3)} {P(몬티2)} \
&=\frac{1 \cdot \frac{1}{9}}{\frac{3}{18}} \
&= \frac{2}{3}
\end{aligned}$$